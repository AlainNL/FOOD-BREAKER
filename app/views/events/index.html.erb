<div class="container">
  <div class="row justify-content-center">
    <div class="col-sm-8">
      <div id="events">

        <div class="input-group my-5" style="padding: 0px 16px 0px 16px">
          <p class="text-sm-start">FoodBreaker, join the network and break the ice otherwise !</p>
            <%= form_tag events_path, method: :get, class: "d-flex justify-content-between" do %>
              <%= text_field_tag :address,
                params[:query],
                class: "form-input",
                placeholder: '&nbsp'.html_safe
              %>
            <%= text_field_tag :language,
              params[:query],
              class: "form-secondary",
              placeholder: '&nbsp'.html_safe
            %>
            <% end %>
            <%= simple_form_for [@event],
                          html: {
                            data: {
                              controller: 'flatpickr'
                            }
                          } do |f| %>
            <%= f.input :date,
                        as: :string,
                        input_html: {
                          class: "form-date",
                          data: {
                            flatpickr_target: 'date',
                          }
                        }, label: '&nbsp'.html_safe, required: false %>
            <% end %>

        </div>

        <%# CONTAINER FILTER CATEGORIES %>
        <div class="categories-filter">
          <button type="button" class="btn btn-filter">Dinner</button>
          <button type="button" class="btn btn-filter">Cooking Class</button>
          <button type="button" class="btn btn-filter">Food Tour</button>
          <button type="button" class="btn btn-filter">Brunch</button>
        </div>

        <div class="card-event-little-all">
          <% @events.each do |event| %>
            <%= link_to event_path(event), class:'card-event-little mb-4' do %>
              <% if event.photos.attached? %>
                <%= cl_image_tag event.photos.first.key, height: 100, width: 200, crop: :fill %>
              <% else %>
                <img src="https://raw.githubusercontent.com/lewagon/fullstack-images/master/uikit/greece.jpg"/>
              <% end %>
              <div class="card-event-little-infos">
                  <h6><%= event.title.capitalize %></h6>
                  <%= Event::FLAGS[event.language.to_sym] %>
              </div>
                  <p><%= event.date.strftime('%d %b %Y') %></p>
                  <% if event.bookings.where(confirmation: true).sum(&:nb_guest) == 0 %>
                    <p style="color: red">Fully Booked!</p>
                  <% else %>
                    <p style="color: #F93C52">ðŸ‘‰ <%= pluralize(event.bookings.where(confirmation: true).sum(&:nb_guest),'place')%></p>
                  <% end %>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
